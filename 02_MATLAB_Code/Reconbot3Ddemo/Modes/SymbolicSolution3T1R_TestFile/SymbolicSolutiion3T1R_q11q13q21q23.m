
% x11 = sin(q11);
% y11 = cos(q11);
% x13 = sin(q13/2);
% y13 = cos(q13/2);
% x21 = sin(q21);
% y21 = cos(q21);
% x23 = sin(q23/2);
% y23 = cos(q23/2);
% x1213 =  sin(q12 + q13/2);
% y1213 =  cos(q12 + q13/2);
% x2223 =  sin(q22 + q23/2);
% y2223 =  cos(q22 + q23/2);


% A1 = l2 * x11 * 2 * y13;
% A2 = l2 * x21 * 2 * y23;
% A3 = l2 * y11 * 2 * y13;
% A4 = l2 * y21 * 2 * y23;

% y1213 = cos(q12 + q13/2) = (1 - x^2) / (1 + x^2);
% x1213 = sin(q12 + q13/2) = 2 * x / (1 + x^2);

syms l1 l2 x11 y11 x13 y13 x21 y21 x23 y23 x1213 y1213 x2223 y2223 
syms A1 A2 A3 A4
[solx1213, soly1213] = solve([ (A1 * y1213 - A2 * y2223)^2 + (A3 * y1213 + A4 * y2223 + l1)^2 - l1^2 == 0,...
                               (y13 * x1213 / y23)^2 + y2223^2 - 1 == 0], [x1213, y1213]);
% [solx1213, soly1213] = solve([ (l2 * x11 * (2 * y13 * y1213) - l2 * x21 * (2 * y23 * y2223))^2 + ...
%                                     (l2 * y11 * (2 * y13 * y1213) + l2 * y21 * (2 * y23 * y2223) + l1)^2 - l1^2 == 0,...
%                                (y13 * x1213 / y23)^2 + y2223^2 - 1 == 0], [x1213, y1213]);
 
% Step 1: 
collect(expand((A1 * y1213 - A2 * y2223)^2 + (A3 * y1213 + A4 * y2223 + l1)^2 - l1^2 == 0), y2223)
 
% Step 2: 
(A2^2 + A4^2)*y2223^2 + (2*A4*l1 - 2*A1*A2*y1213 + 2*A3*A4*y1213)*y2223 + A1^2*y1213^2 + A3^2*y1213^2 + 2*l1*A3*y1213 == 0

% Step 3:
% y2223^2 = 1 - (y13 * x1213 / y23)^2
% pretty(collect(expand(((A2^2 + A4^2)*(y23^2 - (y13 * x1213)^2) + y23^2*(A1^2*y1213^2 + A3^2*y1213^2 + 2*l1*A3*y1213))^2 - (2*A4*l1 - 2*A1*A2*y1213 + 2*A3*A4*y1213)^2 * (y23^2 - (y13 * x1213)^2) == 0), [x1213, y1213]));
collect(expand(((A2^2 + A4^2)*(y23^2 - (y13 * x1213)^2) + y23^2*(A1^2*y1213^2 + A3^2*y1213^2 + 2*l1*A3*y1213))^2 - (2*A4*l1 - 2*A1*A2*y1213 + 2*A3*A4*y1213)^2 * (y23^2 - (y13 * x1213)^2) == 0), [x1213, y1213])
%()*x1213^4 + ()*x1213^2*y1213^2 + ()*x1213^2*y1213 + ()*x1213^2 + ()*y1213^4 + ()*y1213^3 + ()*y1213^2 + ()*y1213 + () == 0

% Step 4:
B1 * x1213^4 + B2 * x1213^2 * y1213^2 + B3 * x1213^2 * y1213 + B4 * x1213^2 + B5 * y1213^4 + B6 * y1213^3 + B7 * y1213^2 + B8 * y1213 + B9 = 0;

B1 = A2^4*y13^4 + 2*A2^2*A4^2*y13^4 + A4^4*y13^4;
B2 = - 2*A1^2*A2^2*y13^2*y23^2 + 4*A1^2*A2^2*y13^2 - 2*A1^2*A4^2*y13^2*y23^2 - 8*A1*A2*A3*A4*y13^2 - 2*A2^2*A3^2*y13^2*y23^2 - 2*A3^2*A4^2*y13^2*y23^2 + 4*A3^2*A4^2*y13^2;
B3 = - 4*A3*l1*A2^2*y13^2*y23^2 - 8*A1*l1*A2*A4*y13^2 - 4*A3*l1*A4^2*y13^2*y23^2 + 8*A3*l1*A4^2*y13^2;
B4 = - 2*A2^4*y13^2*y23^2 - 4*A2^2*A4^2*y13^2*y23^2 - 2*A4^4*y13^2*y23^2 + 4*A4^2*l1^2*y13^2;
B5 = A1^4*y23^4 + 2*A1^2*A3^2*y23^4 + A3^4*y23^4;
B6 = 4*l1*A1^2*A3*y23^4 + 4*l1*A3^3*y23^4;
B7 = 2*A1^2*A2^2*y23^4 - 4*A1^2*A2^2*y23^2 + 2*A1^2*A4^2*y23^4 + 8*A1*A2*A3*A4*y23^2 + 2*A2^2*A3^2*y23^4 + 2*A3^2*A4^2*y23^4 - 4*A3^2*A4^2*y23^2 + 4*A3^2*l1^2*y23^4;
B8 = 4*A3*l1*A2^2*y23^4 + 8*A1*l1*A2*A4*y23^2 + 4*A3*l1*A4^2*y23^4 - 8*A3*l1*A4^2*y23^2;
B9 = A2^4*y23^4 + 2*A2^2*A4^2*y23^4 + A4^4*y23^4 - 4*A4^2*l1^2*y23^2;

% y1213 = (1 - x^2) / (1 + x^2);
% x1213 = 2 * x / (1 + x^2);
% x = tan[(q12 + q13/2)/2]

% Step 5:
syms x
subs(B1 * x1213^4 + B2 * x1213^2 * y1213^2 + B3 * x1213^2 * y1213 + B4 * x1213^2 + B5 * y1213^4 + B6 * y1213^3 + B7 * y1213^2 + B8 * y1213 + B9 == 0, x1213, 2 * x / (1 + x^2))
               B1 * (2 * x)^4 + B2 * (2 * x)^2 * (1 - x^2)^2 + B3 * (2 * x)^2 * (1 - x^2) * (1 + x^2) + B4 * (2 * x)^2 * (1 + x^2)^2 + B5 * (1 - x^2)^4 + B6 * (1 - x^2)^3 * (1 + x^2) + B7 * (1 - x^2)^2 * (1 + x^2)^2 + B8 * (1 - x^2) * (1 + x^2)^3  + B9 * (1 + x^2 )^4 == 0

%Step 6:
collect(expand(B1 * (2 * x)^4 + B2 * (2 * x)^2 * (1 - x^2)^2 + B3 * (2 * x)^2 * (1 - x^2) * (1 + x^2) + B4 * (2 * x)^2 * (1 + x^2)^2 + B5 * (1 - x^2)^4 + B6 * (1 - x^2)^3 * (1 + x^2) + B7 * (1 - x^2)^2 * (1 + x^2)^2 + B8 * (1 - x^2) * (1 + x^2)^3  + B9 * (1 + x^2 )^4 == 0), x)
% We can get:
(A1^4*y23^4 + 2*A1^2*A2^2*y23^4 - 4*A1^2*A2^2*y23^2 + 2*A1^2*A3^2*y23^4 - 4*A1^2*A3*l1*y23^4 + 2*A1^2*A4^2*y23^4 + 8*A1*A2*A3*A4*y23^2 - 8*A1*A2*A4*l1*y23^2 + A2^4*y23^4 + 2*A2^2*A3^2*y23^4 - 4*A2^2*A3*l1*y23^4 + 2*A2^2*A4^2*y23^4 + A3^4*y23^4 - 4*A3^3*l1*y23^4 + 2*A3^2*A4^2*y23^4 - 4*A3^2*A4^2*y23^2 + 4*A3^2*l1^2*y23^4 - 4*A3*A4^2*l1*y23^4 + 8*A3*A4^2*l1*y23^2 + A4^4*y23^4 - 4*A4^2*l1^2*y23^2) * x^8 + ...
    (16*A1^2*A2^2*y13^2 - 8*A1^2*A2^2*y13^2*y23^2 - 4*A1^4*y23^4 - 8*A1^2*A3^2*y23^4 + 8*A1^2*A3*l1*y23^4 - 8*A1^2*A4^2*y13^2*y23^2 - 32*A1*A2*A3*A4*y13^2 + 32*A1*A2*A4*l1*y13^2 - 16*A1*A2*A4*l1*y23^2 - 8*A2^4*y13^2*y23^2 + 4*A2^4*y23^4 - 8*A2^2*A3^2*y13^2*y23^2 + 16*A2^2*A3*l1*y13^2*y23^2 - 8*A2^2*A3*l1*y23^4 - 16*A2^2*A4^2*y13^2*y23^2 + 8*A2^2*A4^2*y23^4 - 4*A3^4*y23^4 + 8*A3^3*l1*y23^4 - 8*A3^2*A4^2*y13^2*y23^2 + 16*A3^2*A4^2*y13^2 + 16*A3*A4^2*l1*y13^2*y23^2 - 32*A3*A4^2*l1*y13^2 - 8*A3*A4^2*l1*y23^4 + 16*A3*A4^2*l1*y23^2 - 8*A4^4*y13^2*y23^2 + 4*A4^4*y23^4 + 16*A4^2*l1^2*y13^2 - 16*A4^2*l1^2*y23^2) * x^6 + ...
    (6*A1^4*y23^4 + 16*A1^2*A2^2*y13^2*y23^2 - 32*A1^2*A2^2*y13^2 - 4*A1^2*A2^2*y23^4 + 8*A1^2*A2^2*y23^2 + 12*A1^2*A3^2*y23^4 + 16*A1^2*A4^2*y13^2*y23^2 - 4*A1^2*A4^2*y23^4 + 64*A1*A2*A3*A4*y13^2 - 16*A1*A2*A3*A4*y23^2 + 16*A2^4*y13^4 - 16*A2^4*y13^2*y23^2 + 6*A2^4*y23^4 + 16*A2^2*A3^2*y13^2*y23^2 - 4*A2^2*A3^2*y23^4 + 32*A2^2*A4^2*y13^4 - 32*A2^2*A4^2*y13^2*y23^2 + 12*A2^2*A4^2*y23^4 + 6*A3^4*y23^4 + 16*A3^2*A4^2*y13^2*y23^2 - 32*A3^2*A4^2*y13^2 - 4*A3^2*A4^2*y23^4 + 8*A3^2*A4^2*y23^2 - 8*A3^2*l1^2*y23^4 + 16*A4^4*y13^4 - 16*A4^4*y13^2*y23^2 + 6*A4^4*y23^4 + 32*A4^2*l1^2*y13^2 - 24*A4^2*l1^2*y23^2) * x^4 + ...
    (16*A1^2*A2^2*y13^2 - 8*A1^2*A2^2*y13^2*y23^2 - 4*A1^4*y23^4 - 8*A1^2*A3^2*y23^4 - 8*A1^2*A3*l1*y23^4 - 8*A1^2*A4^2*y13^2*y23^2 - 32*A1*A2*A3*A4*y13^2 - 32*A1*A2*A4*l1*y13^2 + 16*A1*A2*A4*l1*y23^2 - 8*A2^4*y13^2*y23^2 + 4*A2^4*y23^4 - 8*A2^2*A3^2*y13^2*y23^2 - 16*A2^2*A3*l1*y13^2*y23^2 + 8*A2^2*A3*l1*y23^4 - 16*A2^2*A4^2*y13^2*y23^2 + 8*A2^2*A4^2*y23^4 - 4*A3^4*y23^4 - 8*A3^3*l1*y23^4 - 8*A3^2*A4^2*y13^2*y23^2 + 16*A3^2*A4^2*y13^2 - 16*A3*A4^2*l1*y13^2*y23^2 + 32*A3*A4^2*l1*y13^2 + 8*A3*A4^2*l1*y23^4 - 16*A3*A4^2*l1*y23^2 - 8*A4^4*y13^2*y23^2 + 4*A4^4*y23^4 + 16*A4^2*l1^2*y13^2 - 16*A4^2*l1^2*y23^2) * x^2 + ...
    A1^4*y23^4 + 2*A1^2*A2^2*y23^4 - 4*A1^2*A2^2*y23^2 + 2*A1^2*A3^2*y23^4 + 4*A1^2*A3*l1*y23^4 + 2*A1^2*A4^2*y23^4 + 8*A1*A2*A3*A4*y23^2 + 8*A1*A2*A4*l1*y23^2 + A2^4*y23^4 + 2*A2^2*A3^2*y23^4 + 4*A2^2*A3*l1*y23^4 + 2*A2^2*A4^2*y23^4 + A3^4*y23^4 + 4*A3^3*l1*y23^4 + 2*A3^2*A4^2*y23^4 - 4*A3^2*A4^2*y23^2 + 4*A3^2*l1^2*y23^4 + 4*A3*A4^2*l1*y23^4 - 8*A3*A4^2*l1*y23^2 + A4^4*y23^4 - 4*A4^2*l1^2*y23^2 = 0

% Step 7:
C1 * x^8  + C2 * x^7 + C3 * x^6  + C4 * x^5 + C5 * x^4  + C6 * x^3 + C7 * x^2 + C8 * x^1 + C9 == 0
% C1 = collect((A1^4*y23^4 + 2*A1^2*A2^2*y23^4 - 4*A1^2*A2^2*y23^2 + 2*A1^2*A3^2*y23^4 - 4*A1^2*A3*l1*y23^4 + 2*A1^2*A4^2*y23^4 + 8*A1*A2*A3*A4*y23^2 - 8*A1*A2*A4*l1*y23^2 + A2^4*y23^4 + 2*A2^2*A3^2*y23^4 - 4*A2^2*A3*l1*y23^4  + 2*A2^2*A4^2*y23^4 + A3^4*y23^4 - 4*A3^3*l1*y23^4 + 2*A3^2*A4^2*y23^4 - 4*A3^2*A4^2*y23^2 + 4*A3^2*l1^2*y23^4 - 4*A3*A4^2*l1*y23^4 + 8*A3*A4^2*l1*y23^2 + A4^4*y23^4 - 4*A4^2*l1^2*y23^2), [y13, y23]);
% C2 = 0;
% C3 = collect((16*A1^2*A2^2*y13^2 - 8*A1^2*A2^2*y13^2*y23^2 - 4*A1^4*y23^4 - 8*A1^2*A3^2*y23^4 + 8*A1^2*A3*l1*y23^4 - 8*A1^2*A4^2*y13^2*y23^2 - 32*A1*A2*A3*A4*y13^2 + 32*A1*A2*A4*l1*y13^2 - 16*A1*A2*A4*l1*y23^2 - 8*A2^4*y13^2*y23^2 + 4*A2^4*y23^4 - 8*A2^2*A3^2*y13^2*y23^2 + 16*A2^2*A3*l1*y13^2*y23^2 - 8*A2^2*A3*l1*y23^4 - 16*A2^2*A4^2*y13^2*y23^2 + 8*A2^2*A4^2*y23^4 - 4*A3^4*y23^4 + 8*A3^3*l1*y23^4 - 8*A3^2*A4^2*y13^2*y23^2 + 16*A3^2*A4^2*y13^2 + 16*A3*A4^2*l1*y13^2*y23^2 - 32*A3*A4^2*l1*y13^2 - 8*A3*A4^2*l1*y23^4 + 16*A3*A4^2*l1*y23^2 - 8*A4^4*y13^2*y23^2 + 4*A4^4*y23^4 + 16*A4^2*l1^2*y13^2 - 16*A4^2*l1^2*y23^2), [y13, y23]);
% C4 = 0;
% C5 = collect((6*A1^4*y23^4 + 16*A1^2*A2^2*y13^2*y23^2 - 32*A1^2*A2^2*y13^2 - 4*A1^2*A2^2*y23^4 + 8*A1^2*A2^2*y23^2 + 12*A1^2*A3^2*y23^4 + 16*A1^2*A4^2*y13^2*y23^2 - 4*A1^2*A4^2*y23^4 + 64*A1*A2*A3*A4*y13^2 - 16*A1*A2*A3*A4*y23^2 + 16*A2^4*y13^4 - 16*A2^4*y13^2*y23^2 + 6*A2^4*y23^4 + 16*A2^2*A3^2*y13^2*y23^2 - 4*A2^2*A3^2*y23^4 + 32*A2^2*A4^2*y13^4 - 32*A2^2*A4^2*y13^2*y23^2 + 12*A2^2*A4^2*y23^4 + 6*A3^4*y23^4 + 16*A3^2*A4^2*y13^2*y23^2 - 32*A3^2*A4^2*y13^2 - 4*A3^2*A4^2*y23^4 + 8*A3^2*A4^2*y23^2 - 8*A3^2*l1^2*y23^4 + 16*A4^4*y13^4 - 16*A4^4*y13^2*y23^2 + 6*A4^4*y23^4 + 32*A4^2*l1^2*y13^2 - 24*A4^2*l1^2*y23^2), [y13, y23]);
% C6 = 0;
% C7 = collect((16*A1^2*A2^2*y13^2 - 8*A1^2*A2^2*y13^2*y23^2 - 4*A1^4*y23^4 - 8*A1^2*A3^2*y23^4 - 8*A1^2*A3*l1*y23^4 - 8*A1^2*A4^2*y13^2*y23^2 - 32*A1*A2*A3*A4*y13^2 - 32*A1*A2*A4*l1*y13^2 + 16*A1*A2*A4*l1*y23^2 - 8*A2^4*y13^2*y23^2 + 4*A2^4*y23^4 - 8*A2^2*A3^2*y13^2*y23^2 - 16*A2^2*A3*l1*y13^2*y23^2 + 8*A2^2*A3*l1*y23^4 - 16*A2^2*A4^2*y13^2*y23^2 + 8*A2^2*A4^2*y23^4 - 4*A3^4*y23^4 - 8*A3^3*l1*y23^4 - 8*A3^2*A4^2*y13^2*y23^2 + 16*A3^2*A4^2*y13^2 - 16*A3*A4^2*l1*y13^2*y23^2 + 32*A3*A4^2*l1*y13^2 + 8*A3*A4^2*l1*y23^4 - 16*A3*A4^2*l1*y23^2 - 8*A4^4*y13^2*y23^2 + 4*A4^4*y23^4 + 16*A4^2*l1^2*y13^2 - 16*A4^2*l1^2*y23^2), [y13, y23]);
% C8 = 0;
% C9 = collect((A1^4*y23^4 + 2*A1^2*A2^2*y23^4 - 4*A1^2*A2^2*y23^2 + 2*A1^2*A3^2*y23^4 + 4*A1^2*A3*l1*y23^4 + 2*A1^2*A4^2*y23^4 + 8*A1*A2*A3*A4*y23^2 + 8*A1*A2*A4*l1*y23^2 + A2^4*y23^4 + 2*A2^2*A3^2*y23^4 + 4*A2^2*A3*l1*y23^4 + 2*A2^2*A4^2*y23^4 + A3^4*y23^4 + 4*A3^3*l1*y23^4 + 2*A3^2*A4^2*y23^4 - 4*A3^2*A4^2*y23^2 + 4*A3^2*l1^2*y23^4 + 4*A3*A4^2*l1*y23^4 - 8*A3*A4^2*l1*y23^2 + A4^4*y23^4 - 4*A4^2*l1^2*y23^2), [y13, y23]);


C1 = (A1^4 + 2*A1^2*A2^2 + 2*A1^2*A3^2 - 4*A1^2*A3*l1 + 2*A1^2*A4^2 + A2^4 + 2*A2^2*A3^2 - 4*A2^2*A3*l1 + 2*A2^2*A4^2 + A3^4 - 4*A3^3*l1 + 2*A3^2*A4^2 + 4*A3^2*l1^2 - 4*A3*A4^2*l1 + A4^4)*y23^4 + (- 4*A1^2*A2^2 + 8*A1*A2*A3*A4 - 8*A1*A2*A4*l1 - 4*A3^2*A4^2 + 8*A3*A4^2*l1 - 4*A4^2*l1^2)*y23^2;
C2 = 0;
C3 = (- 8*A1^2*A2^2 - 8*A1^2*A4^2 - 8*A2^4 - 8*A2^2*A3^2 + 16*l1*A2^2*A3 - 16*A2^2*A4^2 - 8*A3^2*A4^2 + 16*l1*A3*A4^2 - 8*A4^4)*y13^2*y23^2 + (16*A1^2*A2^2 - 32*A1*A2*A3*A4 + 32*A1*A2*A4*l1 + 16*A3^2*A4^2 - 32*A3*A4^2*l1 + 16*A4^2*l1^2)*y13^2 + (- 4*A1^4 - 8*A1^2*A3^2 + 8*l1*A1^2*A3 + 4*A2^4 - 8*l1*A2^2*A3 + 8*A2^2*A4^2 - 4*A3^4 + 8*l1*A3^3 - 8*l1*A3*A4^2 + 4*A4^4)*y23^4 + (- 16*A4^2*l1^2 + 16*A3*A4^2*l1 - 16*A1*A2*A4*l1)*y23^2;
C4 = 0;
C5 = (16*A2^4 + 32*A2^2*A4^2 + 16*A4^4)*y13^4 + (16*A1^2*A2^2 + 16*A1^2*A4^2 - 16*A2^4 + 16*A2^2*A3^2 - 32*A2^2*A4^2 + 16*A3^2*A4^2 - 16*A4^4)*y13^2*y23^2 + (- 32*A1^2*A2^2 + 64*A1*A2*A3*A4 - 32*A3^2*A4^2 + 32*A4^2*l1^2)*y13^2 + (6*A1^4 - 4*A1^2*A2^2 + 12*A1^2*A3^2 - 4*A1^2*A4^2 + 6*A2^4 - 4*A2^2*A3^2 + 12*A2^2*A4^2 + 6*A3^4 - 4*A3^2*A4^2 - 8*A3^2*l1^2 + 6*A4^4)*y23^4 + (8*A1^2*A2^2 - 16*A1*A2*A3*A4 + 8*A3^2*A4^2 - 24*A4^2*l1^2)*y23^2;
C6 = 0;
C7 = (- 8*A1^2*A2^2 - 8*A1^2*A4^2 - 8*A2^4 - 8*A2^2*A3^2 - 16*l1*A2^2*A3 - 16*A2^2*A4^2 - 8*A3^2*A4^2 - 16*l1*A3*A4^2 - 8*A4^4)*y13^2*y23^2 + (16*A1^2*A2^2 - 32*A1*A2*A3*A4 - 32*A1*A2*A4*l1 + 16*A3^2*A4^2 + 32*A3*A4^2*l1 + 16*A4^2*l1^2)*y13^2 + (- 4*A1^4 - 8*A1^2*A3^2 - 8*l1*A1^2*A3 + 4*A2^4 + 8*l1*A2^2*A3 + 8*A2^2*A4^2 - 4*A3^4 - 8*l1*A3^3 + 8*l1*A3*A4^2 + 4*A4^4)*y23^4 + (- 16*A4^2*l1^2 - 16*A3*A4^2*l1 + 16*A1*A2*A4*l1)*y23^2;
C8 = 0;
C9 = (A1^4 + 2*A1^2*A2^2 + 2*A1^2*A3^2 + 4*A1^2*A3*l1 + 2*A1^2*A4^2 + A2^4 + 2*A2^2*A3^2 + 4*A2^2*A3*l1 + 2*A2^2*A4^2 + A3^4 + 4*A3^3*l1 + 2*A3^2*A4^2 + 4*A3^2*l1^2 + 4*A3*A4^2*l1 + A4^4)*y23^4 + (- 4*A1^2*A2^2 + 8*A1*A2*A3*A4 + 8*A1*A2*A4*l1 - 4*A3^2*A4^2 - 8*A3*A4^2*l1 - 4*A4^2*l1^2)*y23^2;







% syms l1 l2 x11 y11 x13 y13 x21 y21 x23 y23 x1213 y1213 x2223 y2223
% [solx1213, soly1213] = solve([ (l2 * x11 * (2 * y13 * y1213) - l2 * x21 * (2* y23 * y2223))^2 + ...
%                               (l2 * y11 * (2 * y13 * y1213) + l2 * y21 * (2* y23 * y2223) + l1)^2 + ...
%                                  (l2 * (2 * y13 * x1213) - l2 * (2 * y23 * x2223))^2 - l1^2 == 0,...
%                             y13 * x1213 - y23 * x2223 == 0,...
%                             x2223^2 + y2223^2 - 1 == 0], [x1213, y1213]);

% syms l1 l2 q11 q12 q13 q21 q22 q23
% [solq12, solq22] = solve([ (l2 * sin(q11) * (cos(q12) + cos(q12+q13)) - l2 * sin(q21) * (cos(q22) + cos(q22+q23)))^2 + ...
%                               (l2 * cos(q11) * (cos(q12) + cos(q12+q13)) + l2 * cos(q21) * (cos(q22) + cos(q22+q23)) + l1)^2 + ...
%                                  (l2 * (sin(q12) + sin(q12+q13)) - l2 * (sin(q22) + sin(q22+q23)))^2 - l1^2 == 0,...
%                             sin(q12) + sin(q12+q13) - sin(q22) - sin(q22+q23) == 0], [q12, q22]);

